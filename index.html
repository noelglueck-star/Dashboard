<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Dashboard</title>
<style>
html, body {
  margin:0; padding:0; background:#000; color:#fff; font-family:Palatino, "Palatino Linotype", serif;
}
.dashboard { max-width:480px; margin:0 auto; padding:20px; }
.section { margin-bottom:24px; padding-bottom:14px; border-bottom:1px solid rgba(255,255,255,0.15);}
#greeting { text-align:center; font-size:20px; letter-spacing:1px; margin-bottom:8px;}

/* Clock */
.clock-wrapper { display:flex; justify-content:center; }
.clock { width:110px; height:110px; }
.clock svg { width:100%; height:100%; overflow:visible; }
#date { text-align:center; margin-top:4px; font-size:13px; opacity:0.85; }

/* Weather */
.weather-row { display:flex; justify-content:center; gap:40px; }
.weather-box { flex:1; text-align:center; }
.weather-city { font-size:15px; }
.weather-temp { font-size:24px; margin:4px 0; }
.weather-icon { font-size:24px; }

/* Markets */
#markets-list { display:flex; justify-content:center; gap:20px; margin-top:8px; }
.market-item { display:flex; flex-direction:column; align-items:center; border-bottom:1px solid rgba(255,255,255,0.12); padding-bottom:3px; width:120px; }
.market-up { color:#4caf50; }
.market-down { color:#e53935; }

/* News */
#news-list { display:flex; flex-direction:column; gap:5px; align-items:center; font-size:13px; }
.news-item { text-align:center; padding:3px 0; opacity:0; transform:translateY(6px); transition:opacity 0.6s ease, transform 0.6s ease; }
.news-item.visible { opacity:1; transform:translateY(0); }
.news-item:last-child { border-bottom:none; }

/* World clocks */
.world-clocks { display:flex; justify-content:center; gap:12px; margin-top:12px; }
.world-clock { width:50px; height:50px; display:flex; flex-direction:column; align-items:center; }
.world-clock svg { width:100%; height:100%; overflow:visible; }
.world-label { font-size:10px; margin-top:2px; text-align:center; }

/* Footer */
.footer { display:flex; justify-content:center; margin-top:14px; }
.logo { width:30px; height:30px; border:1px solid rgba(255,255,255,0.5); border-radius:50%; display:flex; align-items:center; justify-content:center; font-size:12px; letter-spacing:1.5px; }
</style>
</head>
<body>
<div class="dashboard">

  <!-- Greeting -->
  <div id="greeting" class="section">Hallo Noel!</div>

  <!-- Clock -->
  <div class="section">
    <div class="clock-wrapper">
      <div class="clock">
        <svg viewBox="0 0 100 100">
          <circle cx="50" cy="50" r="48" stroke="white" stroke-width="1" fill="none"/>
          <line id="hour" x1="50" y1="50" x2="50" y2="30" stroke="white" stroke-width="2"/>
          <line id="minute" x1="50" y1="50" x2="50" y2="20" stroke="white" stroke-width="1.5"/>
          <line id="second" x1="50" y1="50" x2="50" y2="16" stroke="white" stroke-width="1"/>
        </svg>
      </div>
    </div>
    <div id="date"></div>
  </div>

  <!-- Weather -->
  <div class="section">
    <div class="weather-row">
      <div class="weather-box" id="weather-albstadt"></div>
      <div class="weather-box" id="weather-boeblingen"></div>
    </div>
  </div>

  <!-- Markets -->
  <div class="section">
    <h3 style="text-align:center;">MÃ¤rkte</h3>
    <div id="markets-list">Lade Marktdatenâ€¦</div>
  </div>

  <!-- News -->
  <div class="section">
    <h3 style="text-align:center;">Schlagzeilen</h3>
    <div id="news-list">Lade Nachrichtenâ€¦</div>
  </div>

  <!-- World Clocks -->
  <div class="world-clocks section">
    <div class="world-clock">
      <svg viewBox="0 0 100 100">
        <circle cx="50" cy="50" r="48" stroke="white" stroke-width="1" fill="none"/>
        <line class="w-hour" x1="50" y1="50" x2="50" y2="30" stroke="white" stroke-width="2"/>
        <line class="w-minute" x1="50" y1="50" x2="50" y2="20" stroke="white" stroke-width="1.5"/>
      </svg>
      <div class="world-label">Atlanta</div>
    </div>
    <div class="world-clock">
      <svg viewBox="0 0 100 100">
        <circle cx="50" cy="50" r="48" stroke="white" stroke-width="1" fill="none"/>
        <line class="w-hour" x1="50" y1="50" x2="50" y2="30" stroke="white" stroke-width="2"/>
        <line class="w-minute" x1="50" y1="50" x2="50" y2="20" stroke="white" stroke-width="1.5"/>
      </svg>
      <div class="world-label">Seoul</div>
    </div>
    <div class="world-clock">
      <svg viewBox="0 0 100 100">
        <circle cx="50" cy="50" r="48" stroke="white" stroke-width="1" fill="none"/>
        <line class="w-hour" x1="50" y1="50" x2="50" y2="30" stroke="white" stroke-width="2"/>
        <line class="w-minute" x1="50" y1="50" x2="50" y2="20" stroke="white" stroke-width="1.5"/>
      </svg>
      <div class="world-label">Peking</div>
    </div>
    <div class="world-clock">
      <svg viewBox="0 0 100 100">
        <circle cx="50" cy="50" r="48" stroke="white" stroke-width="1" fill="none"/>
        <line class="w-hour" x1="50" y1="50" x2="50" y2="30" stroke="white" stroke-width="2"/>
        <line class="w-minute" x1="50" y1="50" x2="50" y2="20" stroke="white" stroke-width="1.5"/>
      </svg>
      <div class="world-label">Tokio</div>
    </div>
  </div>

  <!-- Footer -->
  <div class="footer">
    <div class="logo">NG</div>
  </div>

</div>

<script>
/* Hauptuhr */
function updateClock() {
  const now = new Date();
  const h = now.getHours() % 12;
  const m = now.getMinutes();
  const s = now.getSeconds();
  document.getElementById("hour").setAttribute("transform",`rotate(${h*30 + m/2} 50 50)`);
  document.getElementById("minute").setAttribute("transform",`rotate(${m*6} 50 50)`);
  document.getElementById("second").setAttribute("transform",`rotate(${s*6} 50 50)`);
  document.getElementById("date").innerText = now.toLocaleDateString("de-DE",{weekday:"long",day:"numeric",month:"long",year:"numeric"});
}
setInterval(updateClock,1000); updateClock();

/* Weltuhren */
function updateWorldClocks(){
  const tz = {Atlanta:"America/New_York", Seoul:"Asia/Seoul", Peking:"Asia/Shanghai", Tokio:"Asia/Tokyo"};
  document.querySelectorAll(".world-clock").forEach(el=>{
    const label = el.querySelector(".world-label").innerText;
    const now = new Date(new Date().toLocaleString("en-US",{timeZone:tz[label]}));
    const h = now.getHours()%12;
    const m = now.getMinutes();
    el.querySelector(".w-hour").setAttribute("transform",`rotate(${h*30 + m/2} 50 50)`);
    el.querySelector(".w-minute").setAttribute("transform",`rotate(${m*6} 50 50)`);
  });
}
setInterval(updateWorldClocks,1000); updateWorldClocks();

/* Wetter */
async function loadWeather(lat, lon, el, city){
  try{
    const res = await fetch(`https://api.open-meteo.com/v1/forecast?latitude=${lat}&longitude=${lon}&current_weather=true`);
    const data = await res.json();
    const w = data.current_weather;
    const icon = w.weathercode<3?"â˜€ï¸":w.weathercode<50?"â˜ï¸":"ðŸŒ§ï¸";
    document.getElementById(el).innerHTML = `<div class="weather-city">${city}</div><div class="weather-temp">${Math.round(w.temperature)}Â°C</div><div class="weather-icon">${icon}</div>`;
  }catch(e){document.getElementById(el).innerHTML="Wetter nicht verfÃ¼gbar";}
}
loadWeather(48.2167,9.0333,"weather-albstadt","Albstadt");
loadWeather(48.6833,9.0167,"weather-boeblingen","BÃ¶blingen");

/* MÃ¤rkte â€“ live von Coingecko */
async function loadMarkets(){
  const container = document.getElementById("markets-list");
  container.innerHTML = "Lade Marktdatenâ€¦";
  try{
    const ids = ["bitcoin","spdr-s-p-500-etf-ondo-tokenized-etf","vanguard-ftse-all-world-etf"];
    const res = await fetch(`https://api.coingecko.com/api/v3/simple/price?ids=${ids.join(",")}&vs_currencies=eur&include_24hr_change=true`);
    const data = await res.json();
    container.innerHTML = "";
    const markets = [
      {name:"Bitcoin", price:data.bitcoin?.eur??0, change:data.bitcoin?.eur_24h_change??0},
      {name:"S&P 500", price:data["spdr-s-p-500-etf-ondo-tokenized-etf"]?.eur??0, change:data["spdr-s-p-500-etf-ondo-tokenized-etf"]?.eur_24h_change??0},
      {name:"FTSE All-World", price:data["vanguard-ftse-all-world-etf"]?.eur??0, change:data["vanguard-ftse-all-world-etf"]?.eur_24h_change??0}
    ];
    markets.forEach(m=>{
      const cls = m.change>=0?"market-up":"market-down";
      const div = document.createElement("div");
      div.className="market-item";
      div.innerHTML=`<div>${m.name}</div><div class="${cls}">â‚¬${m.price.toLocaleString("de-DE")}<br>${m.change.toFixed(2)}%</div>`;
      container.appendChild(div);
    });
  }catch(e){container.innerHTML="Marktdaten nicht verfÃ¼gbar"; console.error(e);}
}
loadMarkets(); setInterval(loadMarkets,5*60*1000);

/* Nachrichten */
async function fetchRSS(url){
  try{
    const res = await fetch(url);
    if(!res.ok) throw new Error("Fetch failed");
    const text = await res.text();
    const parser = new DOMParser();
    const xmlDoc = parser.parseFromString(text,"application/xml");
    const items = xmlDoc.querySelectorAll("item");
    const headlines=[];
    for(let i=0;i<Math.min(items.length,4);i++) headlines.push(items[i].querySelector("title").textContent);
    if(headlines.length===0) throw new Error("No headlines");
    return headlines;
  }catch(e){return null;}
}
async function loadNews(){
  const container=document.getElementById("news-list");
  container.innerHTML="Lade Nachrichtenâ€¦";
  const sources=[
    "https://api.allorigins.win/get?url="+encodeURIComponent("https://www.tagesschau.de/xml/rss2"),
    "https://www.spiegel.de/schlagzeilen/tops/index.rss"
  ];
  let headlines=null;
  for(let src of sources){
    if(src.includes("allorigins")){
      try{
        const res=await fetch(src);
        const json = await res.json();
        const parser = new DOMParser();
        const xmlDoc = parser.parseFromString(json.contents,"application/xml");
        const items = xmlDoc.querySelectorAll("item");
        headlines=[];
        for(let i=0;i<Math.min(items.length,4);i++) headlines.push(items[i].querySelector("title").textContent);
      }catch(e){headlines=null;}
    } else { headlines = await fetchRSS(src); }
    if(headlines && headlines.length>0) break;
  }
  if(headlines && headlines.length>0){
    container.innerHTML="";
    headlines.forEach((title,index)=>{
      const div=document.createElement("div");
      div.className="news-item";
      div.textContent=title;
      container.appendChild(div);
      setTimeout(()=>div.classList.add("visible"),index*150);
    });
  }else{container.innerHTML="Nachrichten derzeit nicht verfÃ¼gbar";}
}
loadNews(); setInterval(loadNews,5*60*1000);
</script>
</body>
</html>