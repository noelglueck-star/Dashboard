<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<title>Dashboard</title>

<style>
@import url('https://fonts.googleapis.com/css2?family=Palatino&display=swap');

body {
  margin: 0;
  background: #000;
  color: #fff;
  font-family: 'Palatino', serif;
  display: flex;
  flex-direction: column;
  align-items: center;
}

/* ================= CLOCK ================= */
#clock-wrapper {
  margin-top: 20px;
  width: 180px;
  height: 180px;
}

#date {
  margin-top: 6px;
  font-size: 0.95em;
  text-align: center;
}

/* ================= SECTIONS ================= */
.section {
  width: 92%;
  max-width: 900px;
  background: #111;
  border-radius: 12px;
  padding: 20px;
  margin-top: 20px;
}

/* ================= WEATHER ================= */
.weather {
  display: flex;
  justify-content: center;
  gap: 80px;
}

.weather-city {
  text-align: center;
  min-width: 140px;
}

.city {
  font-size: 1.2em;
}

.temp {
  font-size: 1.8em;
  margin: 4px 0;
}

.icon {
  font-size: 2em;
}

/* ================= MARKETS ================= */
.market-item {
  margin-bottom: 10px;
  font-size: 1.05em;
}

/* ================= NEWS ================= */
.news-item {
  margin-bottom: 8px;
  text-align: left;
}

.news-item span {
  font-weight: bold;
  margin-right: 6px;
}

/* ================= FOOTER LOGO ================= */
#logo {
  margin: 22px 0;
  width: 36px;
  height: 36px;
  border-radius: 50%;
  border: 2px solid white;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
}
</style>
</head>

<body>

<!-- CLOCK -->
<div id="clock-wrapper">
  <canvas id="clock" width="180" height="180"></canvas>
</div>
<div id="date"></div>

<!-- WEATHER -->
<div class="section weather">
  <div class="weather-city" id="albstadt">
    <div class="city">Albstadt</div>
    <div class="temp">-- Â°C</div>
    <div class="icon">--</div>
  </div>
  <div class="weather-city" id="boeblingen">
    <div class="city">BÃ¶blingen</div>
    <div class="temp">-- Â°C</div>
    <div class="icon">--</div>
  </div>
</div>

<!-- MARKETS -->
<div class="section">
  <h3>MÃ¤rkte</h3>
  <div id="markets"></div>
</div>

<!-- NEWS -->
<div class="section">
  <h3>Schlagzeilen</h3>
  <div id="news"></div>
</div>

<!-- LOGO -->
<div id="logo">NG</div>

<script>
/* ================= CLOCK ================= */
const canvas = document.getElementById("clock");
const ctx = canvas.getContext("2d");
const r = canvas.width / 2;
ctx.translate(r, r);

function drawClock() {
  ctx.clearRect(-r, -r, canvas.width, canvas.height);
  ctx.beginPath();
  ctx.arc(0, 0, r * 0.95, 0, Math.PI * 2);
  ctx.strokeStyle = "#fff";
  ctx.lineWidth = 4;
  ctx.stroke();

  ctx.font = r * 0.15 + "px Palatino";
  ctx.textAlign = "center";
  ctx.textBaseline = "middle";

  for (let n = 1; n <= 12; n++) {
    const ang = (n * Math.PI) / 6;
    ctx.fillText(n, Math.sin(ang) * r * 0.75, -Math.cos(ang) * r * 0.75);
  }

  const now = new Date();
  drawHand((now.getHours() % 12) * Math.PI / 6 + now.getMinutes() * Math.PI / 360, r * 0.5, 5);
  drawHand(now.getMinutes() * Math.PI / 30, r * 0.7, 3);
}

function drawHand(pos, len, width) {
  ctx.beginPath();
  ctx.lineWidth = width;
  ctx.lineCap = "round";
  ctx.rotate(pos);
  ctx.moveTo(0, 0);
  ctx.lineTo(0, -len);
  ctx.stroke();
  ctx.rotate(-pos);
}

setInterval(drawClock, 1000);
drawClock();

document.getElementById("date").textContent =
  new Date().toLocaleDateString("de-DE", {
    weekday: "long",
    year: "numeric",
    month: "long",
    day: "numeric"
  });

/* ================= WEATHER ================= */
const icons = {
  0: "â˜€ï¸", 1: "ðŸŒ¤ï¸", 2: "â˜ï¸", 3: "ðŸŒ§ï¸", 45: "ðŸŒ«ï¸", 61: "ðŸŒ§ï¸", 71: "â„ï¸"
};

async function loadWeather(id, lat, lon) {
  const res = await fetch(
    `https://api.open-meteo.com/v1/forecast?latitude=${lat}&longitude=${lon}&current_weather=true`
  );
  const data = await res.json();
  const w = data.current_weather;
  document.querySelector(`#${id} .temp`).textContent = w.temperature + " Â°C";
  document.querySelector(`#${id} .icon`).textContent = icons[w.weathercode] || "â”";
}

loadWeather("albstadt", 48.224, 9.058);
loadWeather("boeblingen", 48.691, 9.015);

/* ================= MARKETS (FINNHUB) ================= */
const FINNHUB_KEY = "BJILYNPGKWBDD3EK";
const symbols = ["SPY", "QQQ", "DIA"];

async function loadMarkets() {
  const box = document.getElementById("markets");
  box.innerHTML = "";
  for (const s of symbols) {
    const res = await fetch(
      `https://finnhub.io/api/v1/quote?symbol=${s}&token=${FINNHUB_KEY}`
    );
    const d = await res.json();
    if (!d.c) continue;
    const change = ((d.c - d.pc) / d.pc * 100).toFixed(2);
    box.innerHTML += `<div class="market-item">${s}: ${d.c.toFixed(2)} USD (${change}%)</div>`;
  }
}
loadMarkets();
setInterval(loadMarkets, 60000);

/* ================= NEWS ================= */
async function loadNews() {
  const res = await fetch("https://corsproxy.io/?https://www.tagesschau.de/xml/rss2");
  const text = await res.text();
  const xml = new DOMParser().parseFromString(text, "text/xml");
  const items = xml.querySelectorAll("item");
  const box = document.getElementById("news");
  box.innerHTML = "";
  items.forEach((i, idx) => {
    if (idx >= 8) return;
    box.innerHTML += `<div class="news-item"><span>${idx + 1}.</span>${i.querySelector("title").textContent}</div>`;
  });
}
loadNews();
setInterval(loadNews, 300000);
</script>

</body>
</html>